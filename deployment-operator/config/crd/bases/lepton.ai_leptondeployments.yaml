---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.11.3
  creationTimestamp: null
  name: leptondeployments.lepton.ai
spec:
  group: lepton.ai
  names:
    kind: LeptonDeployment
    listKind: LeptonDeploymentList
    plural: leptondeployments
    shortNames:
    - ld
    singular: leptondeployment
  scope: Namespaced
  versions:
  - name: v1alpha1
    schema:
      openAPIV3Schema:
        description: LeptonDeployment is the Schema for the leptondeployments API
        properties:
          apiVersion:
            description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
            type: string
          kind:
            description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
            type: string
          metadata:
            type: object
          spec:
            description: LeptonDeploymentSpec defines the desired state of LeptonDeployment
            properties:
              api_tokens:
                items:
                  description: TokenVar defines the token variable of the deployment.
                  properties:
                    value:
                      type: string
                    value_from:
                      description: TokenValue defines the token value of the deployment.
                      properties:
                        token_name_ref:
                          type: string
                      type: object
                  type: object
                type: array
              auto_scaler:
                description: Autoscaler defines the auto scaling behavior.
                properties:
                  scale_down:
                    description: ScaleDown defines the scale down behavior.
                    properties:
                      no_traffic_timeout:
                        description: Scale down the number of replicas to zero if
                          there is no user traffic for the given duration in seconds.
                          System traffice like Health check and metrics traffic are
                          not considered.
                        format: int32
                        type: integer
                    type: object
                type: object
              bucket_name:
                type: string
              certificate_arn:
                type: string
              efs_access_point_id:
                type: string
              efs_id:
                type: string
              envs:
                items:
                  description: EnvVar defines the environment variable of the deployment.
                  properties:
                    name:
                      type: string
                    value:
                      type: string
                    value_from:
                      description: EnvValue defines the environment variable value
                        of the deployment.
                      properties:
                        secret_name_ref:
                          type: string
                      type: object
                  required:
                  - name
                  type: object
                type: array
              mounts:
                items:
                  description: Mount defines the volumes of the deployment.
                  properties:
                    mount_path:
                      type: string
                    path:
                      type: string
                  required:
                  - mount_path
                  - path
                  type: object
                type: array
              name:
                type: string
              photon_id:
                type: string
              photon_image:
                type: string
              photon_name:
                type: string
              photon_prefix:
                type: string
              pull_image_secrets:
                items:
                  type: string
                type: array
              resource_provider:
                type: string
              resource_requirement:
                description: LeptonDeploymentResourceRequirement defines the resource
                  requirement of the deployment.
                properties:
                  accelerator_num:
                    type: number
                  accelerator_type:
                    type: string
                  cpu:
                    description: CPU is the number of CPU cores required for each
                      replica.
                    type: number
                  ephemeral_storage_in_gb:
                    format: int64
                    type: integer
                  memory:
                    description: Memory is the amount of memory in MiB required for
                      each replica.
                    format: int64
                    type: integer
                  min_replicas:
                    format: int32
                    type: integer
                  resource_shape:
                    description: LeptonDeploymentResourceShape defines the resource
                      shape of the deployment.
                    type: string
                required:
                - cpu
                - memory
                - min_replicas
                type: object
              root_domain:
                type: string
              s3_read_only_access_k8s_secret_name:
                type: string
              service_account_name:
                description: 'TODO: delete ServiceAccountName at some point, which
                  is only used for backward compatibility.'
                type: string
              shared_alb_main_domain:
                description: SharedALBMainDomain is used to construct deployment url,
                  e.g. `adn.app.lepton.ai` in `stable-gpt.adn.app.lepton.ai`
                type: string
              workspace_name:
                type: string
              workspace_token:
                type: string
            required:
            - bucket_name
            - name
            - photon_id
            - photon_image
            - photon_name
            - photon_prefix
            - resource_requirement
            type: object
          status:
            description: LeptonDeploymentStatus defines the observed state of LeptonDeployment
            properties:
              endpoint:
                description: LeptonDeploymentEndpoint defines the endpoint of the
                  deployment.
                properties:
                  external_endpoint:
                    type: string
                  internal_endpoint:
                    type: string
                required:
                - external_endpoint
                - internal_endpoint
                type: object
              state:
                description: LeptonDeploymentState defines the state of the deployment.
                type: string
            required:
            - endpoint
            - state
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
